
<%= stylesheet_link_tag('simple-tabs','datePicker','colorbox','jquery.cluetip.css')%>
<%= javascript_include_tag('simple-tabs','jquery.table.addrow','jquery.datePicker','date','jquery.colorbox-min','jquery.tools.min','jquery.hoverIntent','jquery.cluetip')%>
<%= render 'layouts/loggedinbody'%>

<div id="ch_main_div">
	<p style="font-size:20px; color:#f9a943;margin-left:10px;margin-top:10px; font-weight:bold;">CREATE NEW</p>
	<%= form_for @challenge, :validate => true do |f| %>
		<table width="100%" border="0" style="margin-top:0px;">
  			<tr>
    			<td colspan="4"><p align="left"><%= f.text_field :title, :class => "textfield_effect_nw_tk_title", :id => "on_focus_textfield" %></p></td>	
			</tr>
			<tr>
				<td colspan="4">
					<hr style="color:#0066CC;width:98%; height:2px;">
				</td>
			</tr>
			<tr>
    			<td width="15%"><%= f.label :description, "DESCRIPTION" %></td>
    			<td colspan="3"><%= f.text_area :description, :class => "textarea_nw_tk", :id => "on_focus_textarea" %></td>
  			</tr>
			<tr>
				<td colspan="4">
					<hr style="color:#0066CC;width:98%; height:2px;;">
				</td>
			</tr>
			<%= f.fields_for :point_types do |pt|%>
			<tr>
    			<td><%= pt.label :dateStart, "START POINT" %></td>
    			<td width="18%">
					<%= select_tag "ch_st_date", options_for_select([
						["Choose", "0"],
						["Date","#ch_st_dat"],	 
						["Number","#ch_st_num"]														
						]), :style => "width:197px" 
					%>				
				</td>
				<!--
				<td width="30%">
					<%= pt.text_field :dateStart, :class => "textfield_effect  date-pick", :id => "on_focus_textfield" %>
				</td>
				-->
				<td width="60%">	
					
					<div id="ch_st_dat" style="display:none;">
						<%= pt.text_field :st_value1, :class => "textfield_effect  date-pick" %></br>
					</div>
					<div id="ch_st_num" style="display:none;">
						<%= pt.text_field :st_value, :class => "textfield_effect" %>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						<%= pt.text_field :st_label, :class => "textfield_effect" %>
					</div>
							
			   </td>
  			</tr>
			<tr>
				<td colspan="4">
					<hr style="color:#0066CC;width:98%; height:2px;">
				</td>
			</tr>
			<tr>
    			<td><%= pt.label :dateEnd, "END POINT" %></td>
    			<td>
					<%= select_tag "ch_ed_date", options_for_select([
						["Choose", "0"],							
						["Date","#ch_ed_dat"],	 
						["Number","#ch_ed_num"]														
						]), :style => "width:197px" 
					%>				
				</td>
				<!--
				<td>
					<%= pt.text_field :dateEnd, :class => "textfield_effect  date-pick", :id => "on_focus_textfield" %>
				</td>
				-->
				<td>	
					
					<div id="ch_ed_dat" style="display:none;">
						<%= pt.text_field :ed_value1, :class => "textfield_effect  date-pick" %></br>
					</div>
					<div id="ch_ed_num" style="display:none;">
						<%= pt.text_field :ed_value, :class => "textfield_effect" %>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						<%= pt.text_field :ed_label, :class => "textfield_effect" %>
					</div>
					
				</td>
  			</tr>
			<% end %>
			<tr>
				<td colspan="4">
					<hr style="color:#0066CC;width:98%; height:2px;">
				</td>
			</tr>
			<% fs = 0%>
			<tr>
  				<td>
  					<b id="download_now">CREATE TASK 
					<!--
						<%= link_to image_tag("btn_questionmark_up.png"), test_challenges_path,:class=>"reset_password_popup"%>
    				-->
					<%= image_tag("btn_questionmark_up.png")%></b>
					<div class="cluetip">
					<table>
						<tr>	
    						<td colspan="6"><h2>The score for each task will be added up to determin the winner(s).</h2></td>
  						</tr>
						<tr>
	  					  <td width="38%"><p style="color:#f9a943; font-size:15px;"><b>check box:</b></p></td>
   						  <td width="17%"><input type="text" value="1(Check of the task)" size="18" /></td>
							<td width="3%"><%= image_tag("icon_multiply.png", :height => '15', :width => '10')%></td>
						  <td width="13%"><input type="text" value="point(s) per task" size="14" /></td>
    						<td width="3%"><%= image_tag("icon_equal.png", :height => '10', :width => '10')%></td>
						  <td width="28%"><input type="text" value="Score" size="5" /></td>
  						</tr>
						<tr>
	  					  <td width="36%"><p style="color:#f9a943; font-size:15px;"><b>Self-reported Number:</b></p></td>
   						  <td width="17%"><input type="text" value="Number" size="18" /></td>
							<td><%= image_tag("icon_multiply.png", :height => '15', :width => '10')%></td>
						  <td width="13%"><input type="text" value="point(s) per task" size="14" /></td>
    						<td><%= image_tag("icon_equal.png", :height => '10', :width => '10')%></td>
						  <td width="28%"><input type="text" value="Score" size="5" /></td>
  						</tr>
						<tr>	
  							<td></td>
    						<td colspan="5">e.g. reporting 10 miles for "run treadmill (2 points)" task scores 20 points</td>
  						</tr>		
					</table>
					</div>
				</td>
				<td colspan="3">
    				<div id="new_tsk_field">		
						<table border="1" class="atable">
							<tr>
								<th colspan="2">Score this task by</th>
								<th colspan="2">Point(s)</th>
								<th colspan="2">Task(name)
								<%= image_tag("btn_add_up.png", :class => "alternativeRow", :style => "float:right; margin-right:20px;") %>
							</th>
						    </tr>
							<tr>
								<td>
									<%= select_tag "challenge[ch_task_type][]", options_for_select([
										["Choose", "0"],
										["Check box:1 for checking off the task", "1"],	 
										["Self-report number","2"]														
										]), :style => "width:197px;" 
									%>
								</td>
								<td><%= image_tag("icon_multiply.png", :height => '15', :width => '10')%></td>
								<td>
									<%= text_field_tag "challenge[task_point][]", nil , :class => "textfield_effect_nw_tk_add", :id => "on_focus_textfield" %>								
								</td>
								<td><%= image_tag("icon_slash.png", :height => '20', :width => '5')%></td>
								<td>
									<%= text_field_tag "challenge[task_description][]", nil ,:class => "textfield_effect_nw_tk", :id => "on_focus_textfield" %>
									<%= image_tag("btn_delete_up.png", :class => "delRow", :style => "float:right; margin-top:12px;") %>
								</td>
								<td>&nbsp;</td>
							</tr>
							<tr>
								<td colspan="6">
									<b><%= image_tag("icon_arrow_left.png")%>&nbsp;&nbsp;Do all tasks need to be complete before the challenge is marked complete?</b><br>
									<%= f.radio_button :task_comp, "soc", :class => "chall_type"%>
									<%= f.label "Yes" %>
									<%= f.radio_button :task_comp, "soc", :class => "chall_type"%>
									<%= f.label "No" %>								</td>
							</tr>
						</table>
					</div>
    			</td>
  			</tr>
			<tr>
				<td colspan="4">
					<hr style="color:#0066CC;width:98%; height:2px;">
				</td>
			</tr>
			<tr>
  				<td><b>PRIVACY</b></td>
    			<td colspan="3">
    				<ul class="tabs">
    					<li><a href="#tab1">Social</a></li>
    					<li><a href="#tab2">Personal</a></li>
					</ul>

					<div class="tab_container">
    					<div id="tab1" class="tab_content">
    						<table width="100%" border="0">
  								<tr>
    								<td><%= f.label :soc_who_win, "Who wins?"%></td>
									<td>
										<%= f.select :soc_who_win, options_for_select([
	    									["Choose", "0"],							
											["Add all milestones together","sco1"],
											["1st person to reach End Point","sco2"],	 
											["Highest milestone","sco3"],	
											["Lowest milestone","sco4"],	
											["Participant reaches all milestones","sco5"] 														
 											]), :style => "width:197px" 
 										%>		
									</td>
  								</tr>
  								<tr>
    								<td><%= f.label :soc_how_many_winner, "How many winners?"%></td>
									<td>
										<%= f.select :soc_how_many_winner, options_for_select([
											["Select Categories", "0"],
    										["1", "1"],							
											["3","3"],
											["5","5"],	 
											["All participants win","all"] 														
 											]), :style => "width:197px" 
 										%>		
									</td>
  								</tr>
  								<tr>
    								<td><%= f.label :soc_will_participating, "Participants"%></td>
									<td>
										<div id="fb-root"></div>
    									<script src="http://connect.facebook.net/en_US/all.js"></script>
    									<p>
    										<input type="button"
	      										onclick="sendRequestToManyRecipients(); return false;"
									      		value="INVITE PARTICIPANTS" class="links_invite_p"/>
    									</p>
    									<script>
      										FB.init({
        										appId  : '232592880122189',
        										status : true,
        										cookie : true,
        										oauth: true
      										});
											// to send request to single friend use this function
      										function sendRequestToOneRecipient() {
        									var user_id = document.getElementsByName("user_id")[0].value;
        										FB.ui({method: 'apprequests',
          										message: 'Do Your Best',
          										to: user_id,
        										}, requestCallback);
      										}
											// to send request to many friends use this function
      										function sendRequestToManyRecipients() {
        										FB.ui({method: 'apprequests',
          										message: 'Do Your Best',
        										}, requestCallback);
      										}
      										function requestCallback(response) {
        										// Handle callback here
      										}
    									</script>
									</td>
  								</tr>
							
  								<tr>
  									<td></td>
    								<td>
    									<!--
    									<%= f.check_box :soc%><b>It's belogns to social challenge</b>
										-->
									</td>
  								</tr>
								
							</table>
    					</div>
    					<div id="tab2" class="tab_content">
       						<table width="100%" border="0">
  								<tr>
    								<td><%= f.label :per_who_win, "Who wins?"%></td>
									<td>
										<%= f.select :per_who_win, options_for_select([
    										["Select Categories", "0"],							
											["Add all milestones together","sco1"],
											["1st person to reach End Point","sco2"],	 
											["Highest milestone","sco3"],	
											["Lowest milestone","sco4"],	
											["Participant reaches all milestones","sco5"] 														
 											]), :style => "width:197px" 
 										%>
									</td>
  								</tr>
							</table>  
    					</div>
					</div>
    			</td>
  			</tr>
			<tr>
				<td colspan="4">
					<hr style="color:#0066CC;width:98%; height:2px;">
				</td>
			</tr>
			<!--
			<tr>
    			<td colspan="4"><b><%= f.check_box :save_as_tempalate%>Save this challenge as template in my profile</b></td>
  			</tr>
			-->		
  			<tr>
  				<td></td>
    			<td></td>
    			<td colspan="2">
    				<%= f.submit "DONE", :style => "width: 100px; float:right", :class => "links" %>
    				<%= link_to "CANCEL", challenges_path, :style => "text-decoration: none; color:#fff; float:right" ,:class => "links_cancel"%>
				</td>
  			</tr> 
		</table>
	<% end %>	
</div>

<script type="text/javascript">
jQuery(document).ready(function($) {
	
	// script for change containt of social and personl challenge
	$('ul.tabs li').click(function(){
		//alert("hiiiiii");
		$(".tab_container").reset();
	});
	
	// Add row for new task
	//alert("hiiiiiiiii");
	$(".alternativeRow").btnAddRow({oddRowCSS:"oddRow",evenRowCSS:"evenRow"});
	$(".delRow").btnDelRow();
	
	// Date Picker scripting code
	//alert("Date picker is working");
	$('.date-pick').datePicker({startDate:'01/01/1996'});
	
	//script for changing start point
    $('#ch_st_date').change(function() {
		console.debug('changed...' + $(this));

	});
	
	// script for changing end point
	$('#ch_ed_date').change(function() {
		console.debug('changed...' + $(this));

	});
	
	// script for challenge 
	$('.chall_type').click(function(){
		if ($(this).attr("id") == "challenge_cha_type_per")
		{
			//alert($(this).attr("id"));
			$("#challenge_cha_type_per_div").show("fast");
			$("#challenge_cha_type_soc_div").hide("fast");
		}
		else
		{
			//alert($(this).attr("id"));
			$("#challenge_cha_type_soc_div").show("fast");
			$("#challenge_cha_type_per_div").hide("fast");
		}
		//$("<div></div>").appendTo("div#new_tsk_field");
	});
	
	/*
	// script for tool tip
	$("#download_now").tooltip({ 
		offset: [10, 2],
		effect: 'slide',
		position: "top right"
	});
	*/
	
	// script for clue tip
	$('#download_now').cluetip({attribute: 'id'});
	
	// script for start date
	$('#ch_st_date').change(function() {
		var sel_val = $(this).val();
		//alert("hiiiiiii")
		//alert("new"+sel_val);
		//$('#ch_st_date').hide();
		if ($(this).val() == "#ch_st_dat")
		{
			//alert("date");
			$(sel_val).show();
			$('#ch_st_num').hide();	
		}
		else
		{
			//alert("number");
			$(sel_val).show();
			$('#ch_st_dat').hide();
		}

	});
	
	// script for end date
	$('#ch_ed_date').change(function() {
		var sel_val = $(this).val();
		//alert("hiiiiiii")
		//alert("new"+sel_val);
		//$('#ch_st_date').hide();
		if ($(this).val() == "#ch_ed_dat")
		{
			//alert("date");
			$(sel_val).show();
			$('#ch_ed_num').hide();	
		}
		else
		{
			//alert("number");
			$(sel_val).show();
			$('#ch_ed_dat').hide();
		}

	});
	
	//pop up for task creation hint
	//alert("hiiiii")
	$('.reset_password_popup').colorbox();

});

</script>