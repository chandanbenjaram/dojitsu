<%= javascript_include_tag('ui.progressbar')%>
<%= stylesheet_link_tag('jquery-ui', 'ui.core','ui.progressbar','ui.theme', 'main')%>

<%= render 'layouts/loggedinbody'%>
<div class="challange">
												my dashboard
											</div>
											<% as= current_user.challenges.size %>
											
												
<table>
	<td>
		<content>
				
				<table>
					<td>
						<tr>
							<td>
									<div class="dashboardsidebar">
											
										
											<div class="mychallenge">
													<div id="titlechallenge">
														<div id="title">
															MY CHALLENGES ( <%= as %> ) 
														</div>
														<div class="second_titlechallenge">
															<%= button_to "NEW", new_challenge_url, :class => "new_challenge_button", :method => :get%>
														</div>
													</div>
											
													<div id="subbar">
														<div id="name">
															NAME
														</div>
														<div id="score">
															MY DOJITSU SCORE
														</div>
												
													</div>
													
													<div style="overflow :auto;  height : 440px;" id="challengedetails">
												
														
															<% t=1 %>
																<table>
															<% current_user.challenges.each do |userChallenge| %>
														                <tr>
																	<td id="content1">
																		<% title = userChallenge.title %>
																		<font size=3><b><%= link_to "#{title}",show_per_challenges_path(:id => userChallenge)%><%#= userChallenge.title %></b></font><br><font size=2>by <%= userChallenge.user_id %></font><br><%=  userChallenge.start_point.value %> - <%= userChallenge.end_point.value %> 
																		<br><%if ( userChallenge.child_challenges.size <2 ) %> 
																		<%= userChallenge.child_challenges.size %> Contestant<br>
																		    <% else %>
																			 <%= userChallenge.child_challenges.size %> Contestants<br>
																			 <% end %>
																	</td>
																	<td id="content2">
																	
																			<div id="taskprogress<%= t %>">
																			</div>
																			<br/>
																			<div id="check1">
																				<% x=0 %>
																				<% y=0 %>
																				<% a= 0 %>
																				<% b= 0 %>
																				<% userChallenge.tasks.each do |aTask| %>
																					<% if (aTask.is_complete == 1 ) %>
																						<% a+=Integer(aTask.score) %>
																						<% x+=1 %>
																					<% else %>
																						<% b += aTask.score.to_i %>
																						<% y+=1 %>
																					<% end %>
																					<% end %>
												
																					<div class="update">
																					<%= link_to image_tag("FDFDG.gif", :alt => "Update"),show_per_challenges_path(:id => userChallenge)%>
																						
																					</div>
																					<div class="completedtask"> 
																						<%= a %> points (<%= x %> &nbsp; tasks)
																					</div>
																					<div class="notcompleted">
																						<font size=3 color="#F8981D"><b>to go:</b></font>&nbsp; <font color="white"><%= b %> points (<%= y %>&nbsp; tasks)</font>
																					</div>
																					<script type="text/javascript">
																						$(function() {
																							$("#taskprogress<%= t %>").progressbar({ value: Math.round(((<%= a %>/<%= (a+b) %>)*100)) });
																							$("<p>").attr("id", "check").text($("#taskprogress<%= t %>").progressbar("option", "value") + "% Completed:  ").appendTo("#taskprogress<%= t %>");
																						});
																					</script>
																			</div>
																		
																	</td>
																	<td>
																			<div id="points">
																				&nbsp;&nbsp;<font size=4><b><%= a %></b></font>
																			</div>
																	</td>
																
																
																<% t+=1 %>
															
															 
															  <hr width:100%>
															  </tr>
															<% end %>
															</table>
														
													</div>
												</div>
										</div>
							</td>
						</tr>
						<tr>
							<td>	
								<div class="dashboardsidebar1">
											<div class="mychallenge">
														<div id="titlechallenge">
															<div id="title">
																NEW MESSAGES 
															</div>
															<div class="second_titlechallenge">
																<%= button_to "NEW", new_challenge_url, :class => "new_challenge_button", :method => :get%>
															</div>
														</div>
												
														<div id="subbar">
															<div id="name">
																FROM
															</div>
															<div id="score">
																TIME
															</div>
													
														</div>
												
												</div>
									</div>
								</td>
						</tr>
				</td>
				
				</table>
	
				</content>
      </td>
	  <td valign=top>
			<div class="dashboardsidebar2">
							<div class="whatsnew">
									WHATS NEW
										<div id="viewall">
											&nbsp;&nbsp;VIEW ALL
										</div>
								</div>
								<div id="contentbox">
								</div>
								<div id="contentbox">
								</div>
								<div id="contentbox">
								</div>
			</div>
	</td>
</table>