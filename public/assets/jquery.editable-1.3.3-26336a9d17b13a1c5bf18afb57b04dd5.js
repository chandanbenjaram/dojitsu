(function(a){a.fn.editable=function(b){var c={onEdit:null,onSubmit:null,onCancel:null,editClass:null,submit:null,cancel:null,type:"text",submitBy:"blur",editBy:"click",options:null};if(b=="disable")return this.unbind(this.data("editable.options").editBy,this.data("editable.options").toEditable);if(b=="enable")return this.bind(this.data("editable.options").editBy,this.data("editable.options").toEditable);if(b=="destroy")return this.unbind(this.data("editable.options").editBy,this.data("editable.options").toEditable).data("editable.previous",null).data("editable.current",null).data("editable.options",null);var b=a.extend(c,b);return b.toEditable=function(){$this=a(this),$this.data("editable.current",$this.html()),opts=$this.data("editable.options"),a.editableFactory[opts.type].toEditable($this.empty(),opts),$this.data("editable.previous",$this.data("editable.current")).children().focus().addClass(opts.editClass),opts.submit?a("<button/>").appendTo($this).html(opts.submit).one("mouseup",function(){opts.toNonEditable(a(this).parent(),!0)}):$this.one(opts.submitBy,function(){opts.toNonEditable(a(this),!0)}).children().one(opts.submitBy,function(){opts.toNonEditable(a(this).parent(),!0)}),opts.cancel&&a("<button/>").appendTo($this).html(opts.cancel).one("mouseup",function(){opts.toNonEditable(a(this).parent(),!1)}),a.isFunction(opts.onEdit)&&opts.onEdit.apply($this,[{current:$this.data("editable.current"),previous:$this.data("editable.previous")}])},b.toNonEditable=function(b,c){opts=b.data("editable.options"),b.one(opts.editBy,opts.toEditable).data("editable.current",c?a.editableFactory[opts.type].getValue(b,opts):b.data("editable.current")).html(opts.type=="password"?"*****":b.data("editable.current"));var d=null;a.isFunction(opts.onSubmit)&&c==1?d=opts.onSubmit:a.isFunction(opts.onCancel)&&c==0&&(d=opts.onCancel),d!=null&&d.apply(b,[{current:b.data("editable.current"),previous:b.data("editable.previous")}])},this.data("editable.options",b),this.one(b.editBy,b.toEditable)},a.editableFactory={text:{toEditable:function(b,c){a("<input/>").appendTo(b).val(b.data("editable.current"))},getValue:function(a,b){return a.children().val()}},password:{toEditable:function(b,c){b.data("editable.current",b.data("editable.password")),b.data("editable.previous",b.data("editable.password")),a('<input type="password"/>').appendTo(b).val(b.data("editable.current"))},getValue:function(a,b){return a.data("editable.password",a.children().val()),a.children().val()}},textarea:{toEditable:function(b,c){a("<textarea/>").appendTo(b).val(b.data("editable.current"))},getValue:function(a,b){return a.children().val()}},select:{toEditable:function(b,c){$select=a("<select/>").appendTo(b),a.each(c.options,function(b,c){a("<option/>").appendTo($select).html(c).attr("value",b)}),$select.children().each(function(){var c=a(this);if(c.text()==b.data("editable.current"))return c.attr("selected","selected").text()})},getValue:function(b,c){var d=null;return a("select",b).children().each(function(){if(a(this).attr("selected"))return d=a(this).text()}),d}}}})(jQuery)