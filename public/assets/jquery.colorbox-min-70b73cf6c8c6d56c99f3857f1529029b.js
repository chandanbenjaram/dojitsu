// ColorBox v1.3.16 - a full featured, light-weight, customizable lightbox based on jQuery 1.3+
// Copyright (c) 2011 Jack Moore - jack@colorpowered.com
// Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
(function(a,b,c){function d(b){if(!$){V=b,g(a.extend(Q,a.data(V,l))),E=a(V),W=0,Q.rel!=="nofollow"&&(E=a("."+ba).filter(function(){var b=a.data(this,l).rel||this.rel;return b===Q.rel}),W=E.index(V),W===-1&&(E=E.add(V),W=E.length-1));if(!Y){Y=Z=!0,x.show();if(Q.returnFocus)try{V.blur(),a(V).one(r,function(){try{this.focus()}catch(a){}})}catch(c){}w.css({opacity:+Q.opacity,cursor:Q.overlayClose?"pointer":"auto"}).show(),Q.w=i(Q.initialWidth,"x"),Q.h=i(Q.initialHeight,"y"),_.position(0),u&&F.bind("resize."+v+" scroll."+v,function(){w.css({width:F.width(),height:F.height(),top:F.scrollTop(),left:F.scrollLeft()})}).trigger("resize."+v),f(n,Q.onOpen),P.add(J).hide(),O.html(Q.close).show()}_.load(!0)}}function e(){var a,b=m+"Slideshow_",c="click."+m,d,e,f;Q.slideshow&&E[1]&&(d=function(){L.text(Q.slideshowStop).unbind(c).bind(p,function(){if(W<E.length-1||Q.loop)a=setTimeout(_.next,Q.slideshowSpeed)}).bind(o,function(){clearTimeout(a)}).one(c+" "+q,e),x.removeClass(b+"off").addClass(b+"on"),a=setTimeout(_.next,Q.slideshowSpeed)},e=function(){clearTimeout(a),L.text(Q.slideshowStart).unbind([p,o,q,c].join(" ")).one(c,d),x.removeClass(b+"on").addClass(b+"off")},Q.slideshowAuto?d():e())}function f(b,c){c&&c.call(V),a.event.trigger(b)}function g(b){for(var c in b)a.isFunction(b[c])&&c.substring(0,2)!=="on"&&(b[c]=b[c].call(V));b.rel=b.rel||V.rel||"nofollow",b.href=a.trim(b.href||a(V).attr("href")),b.title=b.title||V.title}function h(a){return Q.photo||/\.(gif|png|jpg|jpeg|bmp)(?:\?([^#]*))?(?:#(\.*))?$/i.test(a)}function i(a,b){return b=b==="x"?F.width():F.height(),typeof a=="string"?Math.round(/%/.test(a)?b/100*parseInt(a,10):parseInt(a,10)):a}function j(c,d){var e=b.createElement("div");return e.id=c?m+c:!1,e.style.cssText=d||!1,a(e)}var k={transition:"elastic",speed:300,width:!1,initialWidth:"600",innerWidth:!1,maxWidth:!1,height:!1,initialHeight:"450",innerHeight:!1,maxHeight:!1,scalePhotos:!0,scrolling:!0,inline:!1,html:!1,iframe:!1,fastIframe:!0,photo:!1,href:!1,title:!1,rel:!1,opacity:.9,preloading:!0,current:"image {current} of {total}",previous:"previous",next:"next",close:"close",open:!1,returnFocus:!0,loop:!0,slideshow:!1,slideshowAuto:!0,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",onOpen:!1,onLoad:!1,onComplete:!1,onCleanup:!1,onClosed:!1,overlayClose:!0,escKey:!0,arrowKey:!0},l="colorbox",m="cbox",n=m+"_open",o=m+"_load",p=m+"_complete",q=m+"_cleanup",r=m+"_closed",s=m+"_purge",t=a.browser.msie&&!a.support.opacity,u=t&&a.browser.version<7,v=m+"_IE6",w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q={},R,S,T,U,V,W,X,Y,Z,$=!1,_,ba=m+"Element";_=a.fn[l]=a[l]=function(b,c){var e=this,f;if(!e[0]&&e.selector)return e;b=b||{},c&&(b.onComplete=c);if(!e[0]||e.selector===undefined)e=a("<a/>"),b.open=!0;return e.each(function(){a.data(this,l,a.extend({},a.data(this,l)||k,b)),a(this).addClass(ba)}),f=b.open,a.isFunction(f)&&(f=f.call(e)),f&&d(e[0]),e},_.init=function(){F=a(c),x=j().attr({id:l,"class":t?m+(u?"IE6":"IE"):""}),w=j("Overlay",u?"position:absolute":"").hide(),y=j("Wrapper"),z=j("Content").append(G=j("LoadedContent","width:0; height:0; overflow:hidden"),I=j("LoadingOverlay").add(j("LoadingGraphic")),J=j("Title"),K=j("Current"),M=j("Next"),N=j("Previous"),L=j("Slideshow").bind(n,e),O=j("Close")),y.append(j().append(j("TopLeft"),A=j("TopCenter"),j("TopRight")),j(!1,"clear:left").append(B=j("MiddleLeft"),z,C=j("MiddleRight")),j(!1,"clear:left").append(j("BottomLeft"),D=j("BottomCenter"),j("BottomRight"))).children().children().css({"float":"left"}),H=j(!1,"position:absolute; width:9999px; visibility:hidden; display:none"),a("body").prepend(w,x.append(y,H)),z.children().hover(function(){a(this).addClass("hover")},function(){a(this).removeClass("hover")}).addClass("hover"),R=A.height()+D.height()+z.outerHeight(!0)-z.height(),S=B.width()+C.width()+z.outerWidth(!0)-z.width(),T=G.outerHeight(!0),U=G.outerWidth(!0),x.css({"padding-bottom":R,"padding-right":S}).hide(),M.click(function(){_.next()}),N.click(function(){_.prev()}),O.click(function(){_.close()}),P=M.add(N).add(K).add(L),z.children().removeClass("hover"),a("."+ba).live("click",function(a){a.button!==0&&typeof a.button!="undefined"||a.ctrlKey||a.shiftKey||a.altKey||(a.preventDefault(),d(this))}),w.click(function(){Q.overlayClose&&_.close()}),a(b).bind("keydown",function(a){Y&&Q.escKey&&a.keyCode===27&&(a.preventDefault(),_.close()),Y&&Q.arrowKey&&!Z&&E[1]&&(a.keyCode===37&&(W||Q.loop)?(a.preventDefault(),N.click()):a.keyCode===39&&(W<E.length-1||Q.loop)&&(a.preventDefault(),M.click()))})},_.remove=function(){x.add(w).remove(),a("."+ba).die("click").removeData(l).removeClass(ba)},_.position=function(a,c){function d(a){A[0].style.width=D[0].style.width=z[0].style.width=a.style.width,I[0].style.height=I[1].style.height=z[0].style.height=B[0].style.height=C[0].style.height=a.style.height}var e,f=Math.max(b.documentElement.clientHeight-Q.h-T-R,0)/2+F.scrollTop(),g=Math.max(F.width()-Q.w-U-S,0)/2+F.scrollLeft();e=x.width()===Q.w+U&&x.height()===Q.h+T?0:a,y[0].style.width=y[0].style.height="9999px",x.dequeue().animate({width:Q.w+U,height:Q.h+T,top:f,left:g},{duration:e,complete:function(){d(this),Z=!1,y[0].style.width=Q.w+U+S+"px",y[0].style.height=Q.h+T+R+"px",c&&c()},step:function(){d(this)}})},_.resize=function(a){if(Y){a=a||{},a.width&&(Q.w=i(a.width,"x")-U-S),a.innerWidth&&(Q.w=i(a.innerWidth,"x")),G.css({width:Q.w}),a.height&&(Q.h=i(a.height,"y")-T-R),a.innerHeight&&(Q.h=i(a.innerHeight,"y"));if(!a.innerHeight&&!a.height){var b=G.wrapInner("<div style='overflow:auto'></div>").children();Q.h=b.height(),b.replaceWith(b.children())}G.css({height:Q.h}),_.position(Q.transition==="none"?0:Q.speed)}},_.prep=function(b){function c(b){_.position(b,function(){var b,c,d,e,i=E.length,j,k;!Y||(k=function(){I.hide(),f(p,Q.onComplete)},t&&X&&G.fadeIn(100),J.html(Q.title).add(G).show(),i>1?(typeof Q.current=="string"&&K.html(Q.current.replace(/\{current\}/,W+1).replace(/\{total\}/,i)).show(),M[Q.loop||W<i-1?"show":"hide"]().html(Q.next),N[Q.loop||W?"show":"hide"]().html(Q.previous),b=W?E[W-1]:E[i-1],d=W<i-1?E[W+1]:E[0],Q.slideshow&&L.show(),Q.preloading&&(e=a.data(d,l).href||d.href,c=a.data(b,l).href||b.href,e=a.isFunction(e)?e.call(d):e,c=a.isFunction(c)?c.call(b):c,h(e)&&(a("<img/>")[0].src=e),h(c)&&(a("<img/>")[0].src=c))):P.hide(),Q.iframe?(j=a("<iframe frameborder=0/>").addClass(m+"Iframe")[0],Q.fastIframe?k():a(j).load(k),j.name=m+ +(new Date),j.src=Q.href,Q.scrolling||(j.scrolling="no"),t&&(j.allowTransparency="true"),a(j).appendTo(G).one(s,function(){j.src="//about:blank"})):k(),Q.transition==="fade"?x.fadeTo(g,1,function(){x[0].style.filter=""}):x[0].style.filter="",F.bind("resize."+m,function(){_.position(0)}))})}function d(){return Q.h=Q.h||G.height(),Q.h=Q.mh&&Q.mh<Q.h?Q.mh:Q.h,Q.h}function e(){return Q.w=Q.w||G.width(),Q.w=Q.mw&&Q.mw<Q.w?Q.mw:Q.w,Q.w}if(!!Y){var g=Q.transition==="none"?0:Q.speed;F.unbind("resize."+m),G.remove(),G=j("LoadedContent").html(b),G.hide().appendTo(H.show()).css({width:e(),overflow:Q.scrolling?"auto":"hidden"}).css({height:d()}).prependTo(z),H.hide(),a(X).css({"float":"none"}),u&&a("select").not(x.find("select")).filter(function(){return this.style.visibility!=="hidden"}).css({visibility:"hidden"}).one(q,function(){this.style.visibility="inherit"}),Q.transition==="fade"?x.fadeTo(g,0,function(){c(0)}):c(g)}},_.load=function(b){var c,d,e=_.prep;Z=!0,X=!1,V=E[W],b||g(a.extend(Q,a.data(V,l))),f(s),f(o,Q.onLoad),Q.h=Q.height?i(Q.height,"y")-T-R:Q.innerHeight&&i(Q.innerHeight,"y"),Q.w=Q.width?i(Q.width,"x")-U-S:Q.innerWidth&&i(Q.innerWidth,"x"),Q.mw=Q.w,Q.mh=Q.h,Q.maxWidth&&(Q.mw=i(Q.maxWidth,"x")-U-S,Q.mw=Q.w&&Q.w<Q.mw?Q.w:Q.mw),Q.maxHeight&&(Q.mh=i(Q.maxHeight,"y")-T-R,Q.mh=Q.h&&Q.h<Q.mh?Q.h:Q.mh),c=Q.href,I.show(),Q.inline?(j().hide().insertBefore(a(c)[0]).one(s,function(){a(this).replaceWith(G.children())}),e(a(c))):Q.iframe?e(" "):Q.html?e(Q.html):h(c)?(a(X=new Image).addClass(m+"Photo").error(function(){Q.title=!1,e(j("Error").text("This image could not be loaded"))}).load(function(){var a;X.onload=null,Q.scalePhotos&&(d=function(){X.height-=X.height*a,X.width-=X.width*a},Q.mw&&X.width>Q.mw&&(a=(X.width-Q.mw)/X.width,d()),Q.mh&&X.height>Q.mh&&(a=(X.height-Q.mh)/X.height,d())),Q.h&&(X.style.marginTop=Math.max(Q.h-X.height,0)/2+"px"),E[1]&&(W<E.length-1||Q.loop)&&(X.style.cursor="pointer",X.onclick=function(){_.next()}),t&&(X.style.msInterpolationMode="bicubic"),setTimeout(function(){e(X)},1)}),setTimeout(function(){X.src=c},1)):c&&H.load(c,function(b,c,d){e(c==="error"?j("Error").text("Request unsuccessful: "+d.statusText):a(this).contents())})},_.next=function(){Z||(W=W<E.length-1?W+1:0,_.load())},_.prev=function(){Z||(W=W?W-1:E.length-1,_.load())},_.close=function(){Y&&!$&&($=!0,Y=!1,f(q,Q.onCleanup),F.unbind("."+m+" ."+v),w.fadeTo(200,0),x.stop().fadeTo(300,0,function(){x.add(w).css({opacity:1,cursor:"auto"}).hide(),f(s),G.remove(),setTimeout(function(){$=!1,f(r,Q.onClosed)},1)}))},_.element=function(){return a(V)},_.settings=k,a(_.init)})(jQuery,document,this)